<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <title>DuoMark Erlang Ops Relative Benchmark</title>

  <link rel="stylesheet" href="/css/reset.css" media="screen, projection">
  <link rel="stylesheet" href="/css/theme.css" media="screen, projection">
  <link rel="stylesheet" href="/css/d3.css" media="screen, projection">

  <style>
  .chart div {
    font: 10px sans-serif;
    background-color: steelblue;
    text-align: right;
    padding: 3px;
    margin: 1px;
    color: white;
  }
  </style>
</head>
<body>
  <div id="page">
    <div class="desc section">
      <div class="main">
        <script src="/js/d3.min.js"></script>
        <script>
          function d3_submit() {
            var form = document.benchmark_request;
            var bench_choice = form.bench.value;
            var elems = form.elems.value;
            var times = form.times.value;
            var url = window.location + "bench_results.yaws?bench=" + bench_choice + "&elems=" + elems + "&times=" + times;
            d3.json(url, function(json) {
               var len = json.results.length;
               var data = [];
               for (i=0;i<len-1;i++) {
                 data.push(json.results[i].loop_time.npm);
               }
               var chart = d3.select("#chart");
               chart.selectAll("div").data(data).enter().append("div")
                    .style("width", function(d) { return d * 10 + "px"; })
                    .text(function(d) { return d; });
               var x = d3.scale.linear().domain([0, d3.max(data)]).range(["0px", "420px"]);
            })
          }
        </script>
        <form name="benchmark_request" method="get">
          <ul>
            <li>
              <label for="bench">Benchmark</label>
              <select name="bench">
                <option value="fun_call">Function Call</option>
                <option value="bin_comp">Binary Comprehension</option>
                <option value="tuple_inx">Tuple Indexing</option>
                <option value="mq_raw">Message Send/Receive</option>
              </select>
            </li>
            <li><label for="elems">Elements</label><input name="elems" type="number" min="1" max="1000000" value="1000"></li>
            <li><label for="times">Repeat</label><input name="times" type="number" min="1" max="100" value="10"></li>
          </ul>
          <b><input type="button" value="Run Benchmark" onclick="d3_submit()" /></b>
        </form>
        <div id="chart" class="chart"></div>
      </div> <!-- /end .main -->

      <div class="sidebar">
      </div> <!-- /end .sidebar -->

    </div> <!-- /end .desc.section -->
  </div> <!-- /end #page -->
</body>
</html>
