<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <meta name="Copyright" content="&copy;2005-2006 DuoMark International, Inc." />
  <title>DuoMark Comparative Erlang Benchmarking</title>

  <link rel="stylesheet" href="/css/reset.css" media="screen, projection">
  <link rel="stylesheet" href="/css/theme.css" media="screen, projection">

  <style>
  .bench_graph div {
    font: 10px sans-serif;
    background-color: #9D2D23;
    text-align: right;
    padding: 3px;
    margin: 1px;
    margin-left:20px;
    color: white;
  }
  </style>
</head>
<body>
  <div class="page">
   <div class="content">
    <header class="page_hdr">
      <h1>Erlang Benchmark Comparisons</h1>
    </header>

    <section class="benchmark">
      <header class="bench_form_hdr">
        <h2>Benchmark Selection</h2>
      </header>
      <section class="bench_form" style="margin-bottom:20px">

        <script src="/js/d3.min.js"></script>
        <script src="/js/bench_menus.js"></script>
        <script>

          function d3_submit() {
            var form = document.benchmark_request;
            var datasize = form.datasize.value ? '&datasize=' + form.datasize.value : '';
            var url = [
                       window.location, 'bench_results.yaws?',
                       'bench_type=',   form.bench_type.value,
                       '&bench=',       form.bench.value,
                       datasize,
                       '&num_execs=',   form.num_execs.value,
                       '&test_times=',  form.test_times.value
                      ].join('');

            d3.json(url, function(json) {
                var len = json.results.length;
                var data = [];
                for (i=0;i<len-1;i++) {
                  data.push(json.results[i].loop_time.npm);
                }
                var chart = d3.select(".bench_graph");
                chart.selectAll("div").remove();
                chart = d3.select(".bench_graph");
                chart.selectAll("div").data(data).enter().append("div")
                     .style("width", function(d) { return d * 2 + "px"; })
                     .text(function(d) { return d; });
                var x = d3.scale.linear().domain([0, d3.max(data)]).range(["0px", "250px"]);
            });
          }
        </script>

        <form name="benchmark_request" method="get">
            <p>
              <select name="bench_type" style="text-align:right" required
                  onload="change_bench_menu('data_access')"
                  onchange="var type = this.options[this.selectedIndex].value; change_bench_menu(type)" >
                <option value="data_access" default>Data Access</option>
                <option value="operator">Operators</option>
                <option value="iterate">Iteration</option>
                <option value="process">Process</option>
                <option value="message">Messaging</option>
                <option value="data_manip">Data Manipulation</option>
              </select>
              <select name="bench" style="text-align:right" required
                  onload="change_bench_desc('list_nth')"
                  onchange="var benchmark = this.options[this.selectedIndex].value; change_bench_desc(benchmark)" >
              </select>
            </p>

            <p id="benchmark_desc" class="desc1" style="clear:both;"></p>
            <p style="float:left"><input type="button" value="Run Benchmark" onclick="d3_submit()" /></p>
            <p style="float:right"><input name="test_times" type="number" min="1" max="100" value="10" required /> times</p>
        </form>
      </section>
      <footer class="bench_form_ftr">
      </footer>
    </section> <!-- /end .benchmark -->

    <section class="main">
      <header class="main_hdr">
        <h2>Performance Results</h2>
      </header>
      <section id="bench_graph" class="bench_graph">
      </section>
      <section class="bench_data">
      </section>
      <footer class="main_ftr">
      </footer>
    </section> <!-- /end .main -->

    <footer class="page_ftr">
      <a href="http://www.duomark.com/"><img style="float:right" src="/icons/dmlogo.gif" valign="bottom"></a>
    </footer>
   </div> <!-- /end .content -->
  </div> <!-- /end .page -->
</body>
</html>
